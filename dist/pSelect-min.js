function type(e){return Object.prototype.toString.call(e).replace(/\[object (.+)\]/i,"$1").toLowerCase()}!function(e){e.fn.pSelect=function(t){return console.time("lay"),this.each(function(){var a=e.extend({placeholder:e(this).attr("placeholder")},e.fn.pSelect.defaults,t);e(this).hide();var n=e(this),l=e("<div>",{class:"pSelect"});l.insertAfter(this),l.css({"font-size":a.baseSize,"text-align":a.align});var c=e("<div>",{class:"pSelect-box"}).text(a.placeholder);c.appendTo(l);var i=document.createElement("div");if(i.className="pSelect-wrapper",a.search.enable){var s=document.createElement("input");s.type="text",s.placeholder=a.search.placeholder;var o=document.createElement("div");o.classList.add("search-box"),o.appendChild(s),i.appendChild(o)}var r=document.createElement("ul");function p(t){void 0===t&&(t="");var a=e("body"),n=e(this).find(".pSelect-wrapper");if("close"===t||n.hasClass("open"))n.removeClass("open"),a.removeClass("pSelect-is-open");else if("open"===t||!n.hasClass("open")){a.hasClass("pSelect-is-open")?e(".pSelect-wrapper").removeClass("open"):a.addClass("pSelect-is-open"),n.addClass("open");try{console.log(s.focus())}catch(e){console.log(e)}}}e(this).find("option").each(function(e,t){var a=document.createElement("li");a.textContent=t.textContent;var n=document.createAttribute("data-value");n.value=t.value,a.setAttributeNode(n),r.appendChild(a)}),i.appendChild(r),l[0].appendChild(i),l.click(function(e){console.log(this),e.target!==s&&p.call(this)}),e(document).on("keydown",".pSelect-is-open",function(e){switch(e.key){case"ArrowDown":e.preventDefault(),(t=l.find(".open .pS-active")).length?t.removeClass("pS-active").next(":not(.hide)").addClass("pS-active"):l.find(".open li:eq(0):not(.hide)").addClass("pS-active");break;case"ArrowUp":var t;e.preventDefault(),(t=l.find(".open li.pS-active")).length?t.removeClass("pS-active").prev(":not(.hide)").addClass("pS-active"):l.find(".open li:last:not(.hide)").addClass("pS-active");break;case"Enter":e.preventDefault(),l.find(".open li.pS-active").click();break;case"Escape":e.preventDefault(),p.call(l,"close")}}),e(i).on("click","li",function(t){var a;t.target!==o&&t.target!==s&&(a=e(this),n.val(a.attr("data-value")).trigger("change"),c.text(a.text()))}),a.search.enable&&s.addEventListener("input",function(){!function(e,t){for(var a=document.querySelectorAll(e),n=0;n<a.length;n++)~a[n].textContent.search(new RegExp(t,"gi"))?a[n].classList.remove("hide"):a[n].classList.add("hide")}(".pSelect-wrapper li",s.value)}),a.ajax.url&&e.get(a.ajax.url,function(){})})},e.fn.pSelect.defaults={baseSize:14,align:"center",search:{enable:!0,placeholder:"Enter 3 characters at least"},ajax:{url:!1}}}(jQuery);