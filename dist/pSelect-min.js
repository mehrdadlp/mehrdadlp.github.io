!function(e){e.fn.pSelect=function(t){console.time("lay"),console.log(this);var a=e.extend({placeholder:e(this).attr("placeholder")},e.fn.pSelect.defaults,t);e(this).hide();var l=e(this),n=e("<div>",{class:"pSelect"});n.insertAfter(this),n.css({"font-size":a.baseSize,"text-align":a.align});var c=e("<div>",{class:"pSelect-box"}).text(a.placeholder);c.appendTo(n);var i=document.createElement("div");if(i.className="pSelect-wrapper",a.search.enable){var o=document.createElement("input");o.type="text",o.placeholder=a.search.placeholder;var s=document.createElement("div");s.classList.add("search-box"),s.appendChild(o),i.appendChild(s)}var r,d,p,u,h=document.createElement("ul");function v(){if(console.log(this),e(this).find(".pSelect-wrapper").toggleClass("open"),e("body").toggleClass("pSelect-is-open"),e("body").hasClass("pSelect-is-open"))try{console.log(o.focus())}catch(e){console.log(e)}}e(this).find("option").each(function(e,t){var a=document.createElement("li");a.textContent=t.textContent;var l=document.createAttribute("data-value");l.value=t.value,a.setAttributeNode(l),h.appendChild(a)}),i.appendChild(h),n[0].appendChild(i),e(document).on("click",".pSelect",(r=function(e){e.target!==o&&v.call(this)},d=300,p=null,u=!1,function(){clearTimeout(p);var e=arguments;!u&&r.apply(this,e),u=!0,p=setTimeout(function(){u=!1},d)})),e(document).on("keydown",".pSelect-is-open",function(e){switch(console.log(e.keyCode),console.log(e.key),e.key){case"ArrowDown":e.preventDefault(),(t=n.find("li.pS-active")).length?t.removeClass("pS-active").next(":not(.hide)").addClass("pS-active"):n.find("li:eq(0):not(.hide)").addClass("pS-active");break;case"ArrowUp":var t;e.preventDefault(),(t=n.find("li.pS-active")).length?t.removeClass("pS-active").prev(":not(.hide)").addClass("pS-active"):n.find("li:last:not(.hide)").addClass("pS-active");break;case"Enter":e.preventDefault(),n.find("li.pS-active").click();break;case"Escape":e.preventDefault(),v.call(n)}}),e(document).on("click",".pSelect-wrapper li",function(t){var a;t.target!==s&&t.target!==o&&(a=e(this),l.val(a.attr("data-value")).trigger("change"),c.text(a.text()))}),a.search.enable&&o.addEventListener("input",function(){!function(e,t){for(var a=document.querySelectorAll(e),l=0;l<a.length;l++)~a[l].textContent.search(new RegExp(t,"gi"))?a[l].classList.remove("hide"):a[l].classList.add("hide")}(".pSelect-wrapper li",o.value)}),a.ajax.url&&e.get(a.ajax.url,function(){}),console.timeEnd("lay")},e.fn.pSelect.defaults={baseSize:14,align:"center",search:{enable:!0,placeholder:"Enter 3 characters at least"},ajax:{url:!1}}}(jQuery);