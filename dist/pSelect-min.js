function type(e){return Object.prototype.toString.call(e).replace(/\[object (.+)\]/i,"$1").toLowerCase()}!function(e){e.fn.pSelect=function(t){return console.time("lay"),this.each(function(){var a=e.extend({placeholder:e(this).attr("placeholder")},e.fn.pSelect.defaults,t);e(this).hide();var n=e(this),l=e("<div>",{class:"pSelect"});l.insertAfter(this),l.css({"font-size":a.baseSize,"text-align":a.align});var c=e("<div>",{class:"pSelect-box"}).text(a.placeholder);c.appendTo(l);var i=document.createElement("div");if(i.className="pSelect-wrapper",a.search.enable){var s=document.createElement("input");s.type="text",s.placeholder=a.search.placeholder;var o=document.createElement("div");o.classList.add("search-box"),o.appendChild(s),i.appendChild(o)}var r,p,d,u,v=document.createElement("ul");function h(t){void 0===t&&(t="");var a=e("body"),n=e(this).find(".pSelect-wrapper");if("close"===t||n.hasClass("open"))n.removeClass("open"),a.removeClass("pSelect-is-open");else if("open"===t||!n.hasClass("open")){a.hasClass("pSelect-is-open")?e(".pSelect-wrapper").removeClass("open"):a.addClass("pSelect-is-open"),n.addClass("open");try{console.log(s.focus())}catch(e){console.log(e)}}}function f(e,t,a){if(e.hasClass("pS-disabled"))return t.preventDefault(),t.stopPropagation(),!1;a&&n.val(e.attr("data-value")).trigger("change"),c.text(e.text())}e(this).find("option").each(function(e,t){var a=document.createElement("li");a.textContent=t.textContent,t.selected&&a.classList.add("pS-active"),t.disabled&&a.classList.add("pS-disabled");var n=document.createAttribute("data-value");n.value=t.value,a.setAttributeNode(n),v.appendChild(a)}),i.appendChild(v),l[0].appendChild(i),f(l.find(".pS-active"),{preventDefault:function(){}}),l.click((r=function(e){e.target!==s&&h.call(this)},p=300,d=null,u=!1,function(){clearTimeout(d);var e=arguments;!u&&r.apply(this,e),u=!0,d=setTimeout(function(){u=!1},p)})),e(document).on("keydown",".pSelect-is-open",function(e){switch(e.key){case"ArrowDown":e.preventDefault(),(t=l.find(".open .pS-active")).length?t.removeClass("pS-active").next(":not(.hide)").addClass("pS-active"):l.find(".open li:eq(0):not(.hide)").addClass("pS-active");break;case"ArrowUp":var t;e.preventDefault(),(t=l.find(".open li.pS-active")).length?t.removeClass("pS-active").prev(":not(.hide)").addClass("pS-active"):l.find(".open li:last:not(.hide)").addClass("pS-active");break;case"Enter":e.preventDefault(),l.find(".open li.pS-active").click();break;case"Escape":e.preventDefault(),h.call(l,"close")}}),e(i).on("click","li",function(t){t.target!==o&&t.target!==s&&f(e(this),t,!0)}),n.on("change",function(){l.trigger("pSelect:update",!1)}),l.on("pSelect:update",function(e,t){f(l.find("li:eq("+n.get(0).selectedIndex+")"),e,t)}),a.search.enable&&s.addEventListener("input",function(){!function(e,t){for(var a=document.querySelectorAll(e),n=0;n<a.length;n++)~a[n].textContent.search(new RegExp(t,"gi"))?a[n].classList.remove("hide"):a[n].classList.add("hide")}(".pSelect-wrapper li",s.value)}),a.ajax.url&&e.get(a.ajax.url,function(){})})},e.fn.pSelect.defaults={baseSize:14,align:"center",search:{enable:!0,placeholder:"Enter 3 characters at least"},ajax:{url:!1}}}(jQuery);